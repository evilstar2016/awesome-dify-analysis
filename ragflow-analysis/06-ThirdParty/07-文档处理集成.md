# 文档处理集成

## 概述

RAGFlow 支持多种文档格式解析，包括 PDF、Office 文档、HTML、Markdown 等。系统采用插件化架构，可以灵活扩展新的解析器。

**核心目录**：[deepdoc/parser/](../../deepdoc/parser/)

## 支持的文档格式

### 1. PDF 处理

#### 1.1 PDFPlumber

**文件**：[deepdoc/parser/pdf_parser.py](../../deepdoc/parser/pdf_parser.py)

**依赖**：`pdfplumber==0.10.4`

**特性**：
- 文本提取
- 表格识别
- 布局分析

#### 1.2 PyPDF

**依赖**：
- `pypdf==6.4.0`
- `pypdf2>=3.0.1`

### 2. Office 文档

#### 2.1 Word (DOCX)

**文件**：[deepdoc/parser/docx_parser.py](../../deepdoc/parser/docx_parser.py)

**依赖**：`python-docx>=1.1.2`

```python
from docx import Document

doc = Document("document.docx")
for paragraph in doc.paragraphs:
    print(paragraph.text)
```

#### 2.2 Excel (XLSX)

**文件**：[deepdoc/parser/excel_parser.py](../../deepdoc/parser/excel_parser.py)

**依赖**：`python-calamine>=0.4.0`

#### 2.3 PowerPoint (PPTX)

**文件**：[deepdoc/parser/ppt_parser.py](../../deepdoc/parser/ppt_parser.py)

**依赖**：
- `python-pptx>=1.0.2`
- `aspose-slides==24.7.0` (仅 x86_64 和 macOS ARM64)

### 3. 富文本格式

#### 3.1 HTML

**文件**：[deepdoc/parser/html_parser.py](../../deepdoc/parser/html_parser.py)

**依赖**：
- `html-text==0.6.2`
- `readability-lxml>=0.8.4`

#### 3.2 Markdown

**文件**：[deepdoc/parser/markdown_parser.py](../../deepdoc/parser/markdown_parser.py)

**依赖**：
- `markdown==3.6`
- `markdownify>=1.2.0`
- `markdown-to-json==2.1.1`

#### 3.3 JSON

**文件**：[deepdoc/parser/json_parser.py](../../deepdoc/parser/json_parser.py)

**依赖**：`demjson3==3.0.6`

### 4. 纯文本

**文件**：[deepdoc/parser/txt_parser.py](../../deepdoc/parser/txt_parser.py)

### 5. OCR 集成

#### MinerU OCR

**文件**：[rag/llm/ocr_model.py](../../rag/llm/ocr_model.py)

```python
class MinerUOcrModel(Base):
    def ocr(self, image):
        """OCR 识别"""
        pass
```

### 6. 高级解析器

#### 6.1 Docling

**文件**：[deepdoc/parser/docling_parser.py](../../deepdoc/parser/docling_parser.py)

#### 6.2 MinerU

**文件**：[deepdoc/parser/mineru_parser.py](../../deepdoc/parser/mineru_parser.py)

#### 6.3 TCADP

**文件**：[deepdoc/parser/tcadp_parser.py](../../deepdoc/parser/tcadp_parser.py)

### 7. 其他格式

#### MSG (Outlook 邮件)

**依赖**：`extract-msg>=0.39.0`

#### Apache Tika (通用)

**依赖**：`tika==2.6.0`

支持 100+ 文件格式。

## 使用示例

### PDF 解析

```python
from deepdoc.parser.pdf_parser import PDFParser

parser = PDFParser()
result = parser.parse("document.pdf")

for page in result['pages']:
    print(f"Page {page['page_num']}")
    print(page['text'])
    print(page['tables'])
```

### Word 解析

```python
from deepdoc.parser.docx_parser import DOCXParser

parser = DOCXParser()
result = parser.parse("document.docx")

print(result['text'])
print(result['images'])
```

## 图像处理

**核心模块**：[deepdoc/vision/](../../deepdoc/vision/)

**依赖**：
- `opencv-python==4.10.0.84`
- `opencv-python-headless==4.10.0.84`
- `pillow>=10.4.0`

## 参考文档

- [pdfplumber 文档](https://github.com/jsvine/pdfplumber)
- [python-docx 文档](https://python-docx.readthedocs.io/)
- [Apache Tika](https://tika.apache.org/)

## 许可证

遵循项目主许可证 [Apache 2.0](../../LICENSE)
