@startuml FastGPT App Management Architecture

!theme plain
skinparam componentStyle rectangle
skinparam backgroundColor white
skinparam Package { 
  BackgroundColor LightGray
  FontColor Blue
}
skinparam component {
  BackgroundColor LightBlue
  BorderColor Black
  ArrowColor Black
  FontColor DarkBlue
}
skinparam note {
  backgroundColor LightYellow
}

title FastGPT 应用管理模块架构图

' 应用类型层
package "应用类型 (App Types)" {
  [Simple 应用\n简单对话] as Simple
  [Agent 应用\n智能体] as Agent
  [Workflow 应用\n工作流编排] as Workflow
  [工具应用\nHTTP/MCP工具集] as Tools
}

' 应用管理层
package "应用管理层 (App Management)" {
  [应用 CRUD\n创建/编辑/删除/复制] as AppCRUD
  [版本管理\n发布/回滚/草稿] as Version
  [权限管理\n团队/协作者] as Permission
  [配置管理\nChatConfig] as Config
}

' 数据存储层
package "数据存储 (Data Storage)" {
  database "MongoDB" {
    [apps 表\n应用主数据] as AppsDB
    [app_versions 表\n版本数据] as VersionDB
  }
}

' 工作流层
package "工作流引擎 (Workflow Engine)" {
  [节点存储\nmodules] as Modules
  [边存储\nedges] as Edges
  [运行时执行] as Runtime
}

' API 层
package "API 层" {
  [/api/core/app/*\n应用管理API] as AppAPI
  [/api/core/app/version/*\n版本管理API] as VersionAPI
  [/api/core/app/tool/*\n工具管理API] as ToolAPI
}

' 关联模块
package "关联模块" {
  [知识库模块\n数据集关联] as Dataset
  [对话模块\n对话记录] as Chat
  [插件模块\n工具集成] as Plugin
}

' 关系连接
Simple --> AppCRUD
Agent --> AppCRUD
Workflow --> AppCRUD
Tools --> AppCRUD

AppCRUD --> AppsDB
Version --> VersionDB
Config --> AppsDB

AppCRUD --> Modules
AppCRUD --> Edges
Modules --> Runtime
Edges --> Runtime

AppAPI --> AppCRUD
VersionAPI --> Version
ToolAPI --> Tools

AppCRUD --> Permission
AppCRUD --> Dataset : 关联数据集
AppCRUD --> Chat : 对话记录
AppCRUD --> Plugin : 工具调用

note right of Simple
  最简单的应用类型
  只包含AI对话节点
end note

note right of Agent
  支持工具调用
  自动决策调用工具
end note

note right of Workflow
  可视化编排
  显式节点连接
end note

note right of Tools
  HTTP工具集
  MCP工具集
end note

@enduml
